---
import fs from "fs";
import path from "path";
import matter from "gray-matter";

import Layout from "../layouts/Layout.astro";

const { topic } = Astro.params;

// Ruta al archivo Markdown según el topic
const filePath = path.resolve("./src/content", `${topic}.md`);

// Leer contenido del archivo
const fileContent = fs.readFileSync(filePath, "utf-8");

// Extraer frontmatter y contenido
const { data, content } = matter(fileContent);

// Exportar getStaticPaths para que Astro genere las páginas estáticas
export async function getStaticPaths() {
  const contentDir = path.resolve("./src/content");
  const files = fs.readdirSync(contentDir);

  return files
    .filter((file) => file.endsWith(".md"))
    .map((file) => ({
      params: { topic: file.replace(/\.md$/, "") },
    }));
}
---

<Layout>
  <article class="max-w-4xl mx-auto p-6 prose prose-invert">
    <h1>{data.title}</h1>
    <p>{data.description}</p>
    <div innerHTML={content}></div>
  </article>
</Layout>
